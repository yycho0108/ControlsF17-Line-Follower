Version 4
SHEET 1 1088 680
WIRE 112 16 96 16
WIRE 144 80 128 80
WIRE 224 80 224 32
WIRE 224 80 208 80
WIRE 368 80 368 32
WIRE 368 80 320 80
WIRE 512 80 432 80
WIRE 656 80 656 0
WIRE 656 80 592 80
WIRE 672 80 656 80
WIRE 736 96 736 0
WIRE 784 96 736 96
WIRE 16 112 16 16
WIRE 32 112 16 112
WIRE 512 112 464 112
WIRE 624 112 592 112
WIRE 672 112 624 112
WIRE 112 128 112 16
WIRE 112 128 96 128
WIRE 128 128 128 80
WIRE 128 128 112 128
WIRE 144 128 128 128
WIRE 224 128 224 80
WIRE 240 128 224 128
WIRE -64 144 -80 144
WIRE 32 144 16 144
WIRE 320 144 320 80
WIRE 320 144 304 144
WIRE 336 144 320 144
WIRE 624 144 624 112
WIRE 240 160 224 160
WIRE -160 176 -160 144
WIRE -160 176 -224 176
WIRE -80 176 -80 144
WIRE -80 176 -160 176
WIRE 16 192 16 144
WIRE 224 208 224 160
WIRE 224 208 208 208
WIRE 432 240 432 80
WIRE 432 240 368 240
WIRE 624 240 624 224
WIRE 128 272 128 128
WIRE 464 288 464 112
WIRE 464 288 368 288
WIRE 512 288 464 288
WIRE 656 288 656 208
WIRE 656 288 592 288
WIRE 672 288 656 288
WIRE 736 304 736 208
WIRE 784 304 736 304
WIRE 432 320 432 240
WIRE 512 320 432 320
WIRE 624 320 592 320
WIRE 672 320 624 320
WIRE 624 336 624 320
WIRE -336 368 -416 368
WIRE -64 384 -144 384
WIRE 192 384 112 384
WIRE -416 400 -416 368
WIRE -400 400 -416 400
WIRE -336 416 -336 368
WIRE -320 416 -336 416
WIRE -144 416 -144 384
WIRE -128 416 -144 416
WIRE 112 416 112 384
WIRE 128 416 112 416
WIRE -400 432 -480 432
WIRE -64 432 -64 384
WIRE -48 432 -64 432
WIRE 192 432 192 384
WIRE 208 432 192 432
WIRE -128 448 -208 448
WIRE 128 448 48 448
FLAG 272 112 Vcc
FLAG 272 176 0
FLAG -624 416 Vcc
FLAG -624 496 0
FLAG -224 16 Vcc
FLAG -224 256 0
FLAG 208 208 VGND
FLAG 704 272 Vcc
FLAG 704 64 Vcc
FLAG 704 128 0
FLAG 704 336 0
FLAG 784 96 Mleft
FLAG 784 304 Mright
FLAG -320 416 VGND
FLAG -480 352 Vcc
FLAG -480 512 0
FLAG 368 288 VGND
FLAG -368 384 Vcc
FLAG -368 448 0
FLAG -48 432 Vref
FLAG -208 368 Vcc
FLAG -208 528 0
FLAG -96 400 Vcc
FLAG -96 464 0
FLAG 624 240 Vref
FLAG 624 416 Vref
FLAG 128 272 Vin
FLAG 368 240 Vpid
FLAG 336 144 Vpid
FLAG 64 96 Vcc
FLAG 64 160 0
FLAG 16 272 0
FLAG -64 112 Voff
FLAG 48 368 Vcc
FLAG 48 528 0
FLAG -160 144 Vin_raw
FLAG 160 400 Vcc
FLAG 160 464 0
FLAG 208 432 Voff
SYMBOL Opamps\\UniversalOpamp2 272 144 R0
SYMATTR InstName U1
SYMBOL voltage -624 400 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value 9V
SYMBOL res -208 112 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Rl
SYMATTR Value 100
SYMBOL res -208 192 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName dR
SYMATTR Value {dR}
SYMBOL res -208 272 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Rs
SYMATTR Value 2K
SYMBOL res 240 112 R90
WINDOW 0 5 42 VBottom 2
WINDOW 3 32 50 VTop 2
SYMATTR InstName R6
SYMATTR Value 600K
SYMBOL res 208 48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 70 58 VTop 2
SYMATTR InstName R7
SYMATTR Value 31.2K
SYMBOL Opamps\\UniversalOpamp2 704 96 R0
SYMATTR InstName U2
SYMBOL Opamps\\UniversalOpamp2 704 304 R0
SYMATTR InstName U3
SYMBOL res 640 16 R270
WINDOW 0 31 76 VTop 2
WINDOW 3 60 30 VBottom 2
SYMATTR InstName Rf1
SYMATTR Value {Rf}
SYMBOL res 640 224 R270
WINDOW 0 28 108 VTop 2
WINDOW 3 58 59 VBottom 2
SYMATTR InstName Rf2
SYMATTR Value {Rf}
SYMBOL cap 368 16 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 -27 2 VBottom 2
SYMATTR InstName C1
SYMATTR Value 47µF
SYMBOL res -496 336 R0
SYMATTR InstName R3
SYMATTR Value 1K
SYMBOL res -496 416 R0
SYMATTR InstName R4
SYMATTR Value 1K
SYMBOL Opamps\\UniversalOpamp2 -368 416 R0
SYMATTR InstName U4
SYMBOL res -224 352 R0
SYMATTR InstName R1
SYMATTR Value .5K
SYMBOL res -224 432 R0
SYMATTR InstName R2
SYMATTR Value 1K
SYMBOL Opamps\\UniversalOpamp2 -96 432 R0
SYMATTR InstName U5
SYMBOL res 608 64 R90
WINDOW 0 -6 34 VBottom 2
WINDOW 3 -35 76 VTop 2
SYMATTR InstName R5
SYMATTR Value {Ri}
SYMBOL res 608 96 R90
WINDOW 0 60 37 VBottom 2
WINDOW 3 32 80 VTop 2
SYMATTR InstName R10
SYMATTR Value {Ri}
SYMBOL res 608 272 R90
WINDOW 0 -1 34 VBottom 2
WINDOW 3 -30 81 VTop 2
SYMATTR InstName R11
SYMATTR Value {Ri}
SYMBOL res 608 304 R90
WINDOW 0 65 35 VBottom 2
WINDOW 3 36 86 VTop 2
SYMATTR InstName R12
SYMATTR Value {Ri}
SYMBOL res 640 432 R180
WINDOW 0 -43 73 Left 2
WINDOW 3 -42 42 Left 2
SYMATTR InstName R13
SYMATTR Value {Rf}
SYMBOL res 640 240 R180
WINDOW 0 36 66 Left 2
WINDOW 3 36 34 Left 2
SYMATTR InstName R14
SYMATTR Value {Rf}
SYMBOL cap 144 96 R270
WINDOW 0 24 4 VTop 2
WINDOW 3 78 31 VBottom 2
SYMATTR InstName C3
SYMATTR Value 2.2µF
SYMBOL Opamps\\UniversalOpamp2 64 128 R0
SYMATTR InstName U6
SYMBOL res -80 160 R270
WINDOW 0 -38 65 VTop 2
WINDOW 3 -22 19 VBottom 2
SYMATTR InstName R8
SYMATTR Value {Rd}
SYMBOL res 32 96 R90
WINDOW 0 -15 36 VBottom 2
WINDOW 3 -43 74 VTop 2
SYMATTR InstName R9
SYMATTR Value {Rd}
SYMBOL res 112 0 R90
WINDOW 0 -6 54 VBottom 2
WINDOW 3 -69 55 VTop 2
SYMATTR InstName R15
SYMATTR Value {Gi*Rd}
SYMBOL res 0 176 R0
WINDOW 0 43 19 Left 2
WINDOW 3 28 48 Left 2
SYMATTR InstName R16
SYMATTR Value {Gi*Rd}
SYMBOL res 32 432 R0
SYMATTR InstName R17
SYMATTR Value 1K
SYMBOL res 32 352 R0
SYMATTR InstName R18
SYMATTR Value {Roff}
SYMBOL Opamps\\UniversalOpamp2 160 432 R0
SYMATTR InstName U7
TEXT -856 64 Left 2 !.param k_p=15
TEXT -856 96 Left 2 !.param k_i=7.07
TEXT -856 128 Left 2 !.param k_d=14.1
TEXT -856 224 Left 2 !.param Rf={Ri}
TEXT -856 192 Left 2 !.param Ri=5K
TEXT -856 256 Left 2 !.param Ro = 500K
TEXT -640 88 Left 2 ;.step param dR 1K 3K 100
TEXT -640 24 Left 2 !.tran 0 {t0+dt} {t0} uic
TEXT -856 32 Left 2 !.param t0=.2m
TEXT -856 160 Left 2 !.param d=0.11
TEXT -280 600 Left 2 ;.save V(mleft) V(mright) V(vref) V(vcc) V(vgnd) V(vin) V(Vpid)
TEXT -640 128 Left 2 !.ic V(vcc)=9
TEXT -848 -128 Left 2 !.MEASURE TRAN m_left FIND V(mleft) AT={t0+0.9*dt}\n.MEASURE TRAN m_right FIND V(mright) AT={t0+0.9*dt}\n.MEASURE TRAN v_in FIND V(vin) AT={t0+0.9*dt}\n.MEASURE TRAN v_pid FIND V(vpid) AT={t0+0.9*dt}
TEXT -640 56 Left 2 !.param dR=1K
TEXT -856 288 Left 2 !.param dt = 10.0
TEXT -856 320 Left 2 !.param v_s=80
TEXT -856 352 Left 2 !.param Rd=1K
TEXT -856 384 Left 2 !.param Gi=5
TEXT -856 416 Left 2 !.param Roff=2.3K
